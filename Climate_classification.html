
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Climate classifications &#8212; Porfolio Earth System Components</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Climate_classification';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Climatology, anomalies and El Nino Southern Oscillation" href="Anomalies_and_ENSO.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/Leipzig_logo.svg" class="logo__image only-light" alt="Porfolio Earth System Components - Home"/>
    <img src="_static/Leipzig_logo.svg" class="logo__image only-dark pst-js-only" alt="Porfolio Earth System Components - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Porfolio Gloria Carrascal
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Earth System Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Introduction_Xarray.html">Introduction to JupyterLab, Python and Conda</a></li>
<li class="toctree-l1"><a class="reference internal" href="Energy-balance.html">The Energy balance of the Earth</a></li>
<li class="toctree-l1"><a class="reference internal" href="Layer-Atmosphere.html">Exercise: Sensitivity Analysis of a Two-Layer Atmosphere Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Anomalies_and_ENSO.html">Climatology, anomalies and El Nino Southern Oscillation</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">Climate classifications</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/glohalo/earth_system_porfolio" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/glohalo/earth_system_porfolio/issues/new?title=Issue%20on%20page%20%2FClimate_classification.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Climate_classification.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Climate classifications</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-from-vegetation-information">Classification from vegetation information</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-climate-classification-based-on-climate-and-vegetation">Exercise: Climate classification based on climate and vegetation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-1">Task 1:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-maximum-gpp-value-in-the-msc-at-each-pixel">Find the maximum GPP value in the MSC at each pixel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-out-the-day-of-year-doy-of-maximum-gpp-at-each-pixel-check-idxmax-function">Find out the day of year (DOY) of maximum GPP at each pixel (check .idxmax() function)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-mean-annual-temperature-and-mean-annual-soil-moisture-find-their-values-at-doy-of-maximum-gpp">For mean annual temperature and mean annual soil moisture, find their values at DOY of maximum GPP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-if-these-values-are-larger-smaller-than-the-average-temperature-and-soil-moisture-at-each-pixel">Determine if these values are larger/smaller than the average temperature and soil moisture at each pixel</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions-classification">Conclusions Classification</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="climate-classifications">
<h1>Climate classifications<a class="headerlink" href="#climate-classifications" title="Link to this heading">#</a></h1>
<p>Aims of this notebook:</p>
<ul class="simple">
<li><p>understand the main ways to classify the land surface by climate and/or vegetation</p></li>
<li><p>create your own classification using <code class="docutils literal notranslate"><span class="pre">xr.where</span></code></p></li>
<li><p>understand data masking ub xarray using <code class="docutils literal notranslate"><span class="pre">.where</span></code></p></li>
<li><p>understand the <code class="docutils literal notranslate"><span class="pre">dayofyear</span></code> axis</p></li>
<li><p>apply the functions <code class="docutils literal notranslate"><span class="pre">.max</span></code> and <code class="docutils literal notranslate"><span class="pre">.idxmax</span></code> to find maxima and their indices in the data</p></li>
<li><p>practice data manipulation with <code class="docutils literal notranslate"><span class="pre">.groupby</span></code>,  etc.</p></li>
</ul>
<p>Climate classifications are a way of grouping different areas of the world based on their climate, or the average weather conditions, in a particular region over a long period of time. Climate classes are used in many fields, including agriculture, forestry and urban planning, to help understand the unique weather patterns and natural resources of an area and how they may affect human activities.</p>
<p>There are many different ways to classify climate, but one of the most widely used systems is the Köppen-Geiger climate classification system developed in the late 1800s by German climatologist Wladimir Köppen (see <a class="reference external" href="https://koeppen-geiger.vu-wien.ac.at/present.htm">https://koeppen-geiger.vu-wien.ac.at/present.htm</a>. for background also <a class="reference external" href="https://www.britannica.com/science/Koppen-climate-classification">https://www.britannica.com/science/Koppen-climate-classification</a>). The Köppen-Geiger system divides climates into five main groups: tropical, arid, temperate, continental and polar. Within each of these groups there are sub-categories based on specific temperature and precipitation patterns.
Climate classes are useful because they provide a standardised way of comparing and understanding the climate/weather patterns of different regions. They allow us to identify areas with similar climates and make informed decisions about how best to use and manage natural resources in those regions. For example, a farmer in a tropical climate may need to consider different crops and irrigation strategies than a farmer in an arid climate. Similarly, an urban planner designing a city in a temperate climate may need to consider different building materials and energy efficiency measures than a planner in a polar climate.</p>
<p><img src=https://koeppen-geiger.vu-wien.ac.at/pics/map.jpg width="700"/> Source: <a class="reference external" href="https://koeppen-geiger.vu-wien.ac.at/">https://koeppen-geiger.vu-wien.ac.at/</a></p>
<section id="classification-from-vegetation-information">
<h2>Classification from vegetation information<a class="headerlink" href="#classification-from-vegetation-information" title="Link to this heading">#</a></h2>
<p>The Earth’s surface can also be classified into regions with different characteristics by taking into account information on plants and ecosystems present in different areas (introductory summary e.g. here: <a class="reference external" href="https://www.climate.gov/maps-data/climate-data-primer/how-do-scientists-classify-different-types-climate">https://www.climate.gov/maps-data/climate-data-primer/how-do-scientists-classify-different-types-climate</a>). These classifications result for example in regional biomes (<a class="reference external" href="https://en.wikipedia.org/wiki/Biome">https://en.wikipedia.org/wiki/Biome</a>) or ecoregions (e.g. <a class="reference external" href="https://academic.oup.com/bioscience/article-abstract/51/11/933/227116?redirectedFrom=fulltext">Olson et al., 2001</a>, see a map here: <a class="reference external" href="https://ecoregions.appspot.com/">https://ecoregions.appspot.com/</a>). Climate and vegetation distribution are closely linked, since climate sets the limits for which types of vegetation can naturally occur. So you can observe many similarities between the two maps.</p>
<p><img src=https://upload.wikimedia.org/wikipedia/commons/e/e4/Vegetation.png width="700"/> Source: <a class="reference external" href="https://en.wikipedia.org/wiki/Biome">https://en.wikipedia.org/wiki/Biome</a></p>
<p>Further details in the lecture, and in Gordon Bonan - Ecological Climatology, Chapters (1,2,)6,24: <a class="reference external" href="https://www.cambridge.org/core/books/ecological-climatology/D146443B007985BC366B2512345692C0">https://www.cambridge.org/core/books/ecological-climatology/D146443B007985BC366B2512345692C0</a></p>
<p>In the following exercise, we want to create a simple classification of the Earth surface based on information of both climate and vegetation.</p>
</section>
<section id="exercise-climate-classification-based-on-climate-and-vegetation">
<h2>Exercise: Climate classification based on climate and vegetation<a class="headerlink" href="#exercise-climate-classification-based-on-climate-and-vegetation" title="Link to this heading">#</a></h2>
<p>Gross primary productivity (GPP) is the rate at which plants produce organic matter through photosynthesis. It is an important measure of the health and productivity of an ecosystem and is often used to understand how different climate conditions affect plant growth and productivity.</p>
<p>One way in which GPP can be used to create climate classes is by looking at the relationship between GPP and temperature. In general, plants tend to have higher GPP at warmer temperatures because they are able to photosynthesize more efficiently at higher temperatures. However, there is a point at which temperatures become too high and plants begin to experience stress, leading to a decrease in GPP. By analysing the relationship between GPP and temperature in different regions, it is possible to identify areas with similar such GPP-climate relationship and group them into different climate classes.
Analogously, GPP can be used to create climate classes by looking at the relationship between GPP and precipitation. In general, plants tend to have higher GPP in areas with adequate water availability, as water is necessary for photosynthesis and plant growth. By analysing the relationship between GPP and precipitation in different regions, it is possible to identify areas with similar such GPP-climate relationship and group them into different climate classes.</p>
<p>A simple approximation to distinguish these climatic conditions is by looking at the timing of maximum GPP together with temperature and precipitation: At the time of highest productivity (= maximum GPP) during a year, are temperature and precipitation higher or lower than their annual mean?). So we want to classify the land surface by how climate is related to GPP: Over the the yearly cycle (mean seasonal cycle), is GPP highest in a month with high temperature (for example in Germany, in summer)? Or is GPP highest at a month with lower than average temperature (for example in Spain, in fall and winter)? We can use this as a rough estimation to understand if in that area, temperature is above or below the optimum for plant growth. We can ask the same questions for soil moisture to find out if the moisture in that area is above or below optimum for plant growth.</p>
<p><strong>TODO: Produce a map of climate classes based on GPP. The classes should be assigned according to energy and water availability (whether temperature and soil moisture at the time of maximum GPP are higher or lower than the annual mean for that location). Temperature and soil moisture are interpreted as the driving climate factors as they set the energy and water limits.</strong></p>
<p><strong>Therefore, determine their mean seasonal cycles (MSC) of each location. Pick the day of the year in which GPP MSC is at its maximum. Prepare a classification of 4 classes according to energy and water availability: are temperature MSC and soil moisture MSC higher or lower than their average at the timing of maximum GPP at this location?</strong></p>
<p>So the four classes we will define are:</p>
<ul class="simple">
<li><p>higher than average temperature &amp; higher than average soil moisture at maximum GPP</p></li>
<li><p>higher than average temperature &amp; lower than average soil moisture at maximum GPP</p></li>
<li><p>lower than average temperature &amp; higher than average soil moisture at maximum GPP</p></li>
<li><p>lower than average temperature &amp; lower than average soil moisture at maximum GPP</p></li>
</ul>
<p><em>Additional hints:</em><br />
You can program the task according to your own ideas or follow the steps below.</p>
<ol class="arabic simple">
<li><p>Calculate the mean seasonal cycle (MSC) of GPP, temperature and soil moisture at each pixel (<code class="docutils literal notranslate"><span class="pre">.groupby('time.dayofyear').mean(skipna=True)</span></code>). You can plot the MSCs for one or two example pixels to get an idea of the data. Check the dataset coordinates <code class="docutils literal notranslate"><span class="pre">.coords</span></code> to understand the new <code class="docutils literal notranslate"><span class="pre">dayofyear</span></code> axis (the time steps are dt=8days or 16 days, so the year has 46 or 23 values of DOYs, depending on the cube used).</p></li>
<li><p>Find the maximum GPP value in the MSC at each pixel, and plot a map with these maximal GPP values (check e.g. the <code class="docutils literal notranslate"><span class="pre">.max()</span></code> function)</p></li>
<li><p>Find out the day of year (DOY) of maximum GPP at each pixel (check <code class="docutils literal notranslate"><span class="pre">.idxmax()</span></code> function). This is your mask to determine temperature and soil moisture at DOY of maximum GPP (it has the same set of values as the <code class="docutils literal notranslate"><span class="pre">dayofyear</span></code> axis, so you can use it to filter). Plot a map of DOY of maximum GPP to check out the data.</p></li>
<li><p>For mean annual temperature and mean annual soil moisture, find their values at DOY of maximum GPP (use e.g. <code class="docutils literal notranslate"><span class="pre">x.where(x['dayofyear']</span> <span class="pre">==</span> <span class="pre">mask)</span></code> to mask all data except the corresponding value at DOY of maximum GPP, where <code class="docutils literal notranslate"><span class="pre">x</span></code> is your xarray). It helps to look at a timeseries at one pixel to understand what is happening. You then need to aggregate by <code class="docutils literal notranslate"><span class="pre">.max('dayofyear',</span> <span class="pre">skipna=True)</span></code> to only retain the one value which is not masked to NaN at each pixel (dropping the dayofyear axis, so you now have a map with lan/lon dimensions only).</p></li>
<li><p>Determine if these values are larger/smaller than the average temperature and soil moisture at each pixel. (You can calculate their averages from the MSC cubes from step 1 with <code class="docutils literal notranslate"><span class="pre">.mean()</span></code>, to lower computation cost)</p></li>
<li><p>Create a classification over these maps according to the difference between temperature at DOY of maximum GPP to average temperature, as well as and soil moisture at DOY of maximum GPP to average soil moisture (use e.g. <code class="docutils literal notranslate"><span class="pre">xr.where()</span></code>:(<a class="reference external" href="https://xarray.pydata.org/en/v0.8.2/generated/xarray.Dataset.where.html">https://xarray.pydata.org/en/v0.8.2/generated/xarray.Dataset.where.html</a>))</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">xr.where()</span></code> has a slightly difficult syntax so here is an example of the code structure, where <code class="docutils literal notranslate"><span class="pre">a,b,c,d</span></code> are placeholders of your datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="c1"># condition 1: pixels where a&gt;b and c&gt;d will be marked with number 1 in the output array</span>
    <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="c1"># condition 2</span>
    <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="c1"># condition 3</span>
    <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="c1"># condition 4</span>
    <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="mi">2</span><span class="n">d_map_xarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)))))</span> <span class="c1"># fill rest of array with NaN at the pixels with no values, use any of your xarrays with lat/lon dimension here</span>
</pre></div>
</div>
<p><strong>TODO</strong> Plot maps at least of maximum GPP, and of the final classification, and comment on your resuls in a few sentences: Which areas of the land surface are grouped together, and roughly how does the map compare with the Koeppen and biome map above?</p>
<p>The calculations take quite long, so I recommend you use the small version of the cube at least for developing your code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import modules</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">fsspec</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mcolors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># import modules</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span><span class="w"> </span><span class="nn">fsspec</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;numpy&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Choose the cube as in previous notebooks, based on how you are working (on SC cluster or local computer)</span>
<span class="c1">## We are using the new version of the ESDC again which has a small version for download</span>

<span class="c1">#cube_path = &#39;/software/databases/rsc4earth/EarthSystemDataCube/v3.0.2/esdc-8d-0.25deg-256x128x128-3.0.2.zarr/&#39;</span>
<span class="n">cube_path</span> <span class="o">=</span> <span class="s1">&#39;/software/databases/rsc4earth/EarthSystemDataCube/v3.0.2/esdc-16d-2.5deg-46x72x1440-3.0.2.zarr/&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#ds = xr.open_zarr(fsspec.get_mapper(&#39;http://data.rsc4earth.de/EarthSystemDataCube/v2.1.1/esdc-8d-0.25deg-184x90x90-2.1.1.zarr/&#39;), \</span>
<span class="c1">#                  consolidated=True)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_zarr</span><span class="p">(</span><span class="n">fsspec</span><span class="o">.</span><span class="n">get_mapper</span><span class="p">(</span><span class="n">cube_path</span><span class="p">),</span> \
                  <span class="n">consolidated</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The datases you need</span>
<span class="n">ds</span><span class="o">.</span><span class="n">air_temperature_2m</span>
<span class="n">ds</span><span class="o">.</span><span class="n">gross_primary_productivity</span>
<span class="n">ds</span><span class="o">.</span><span class="n">sm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;sm&#x27; (time: 989, lat: 72, lon: 144)&gt;
dask.array&lt;open_dataset-34e81041f61de522d0cf385f2d6ea605sm, shape=(989, 72, 144), dtype=float32, chunksize=(46, 72, 144), chunktype=numpy.ndarray&gt;
Coordinates:
  * lat      (lat) float64 -88.75 -86.25 -83.75 -81.25 ... 83.75 86.25 88.75
  * lon      (lon) float64 -178.8 -176.2 -173.8 -171.2 ... 173.8 176.2 178.8
  * time     (time) datetime64[ns] 1979-01-09 1979-01-25 ... 2021-12-27
Attributes: (12/25)
    acknowledgment:             ESA Soil Moisture Climate Change Initiative (...
    date_modified:              2022-10-13 20:42:41.277132
    description:                ESA Soil Moisture Climate Change Initiative (...
    geospatial_lat_max:         89.875
    geospatial_lat_min:         -89.875
    geospatial_lat_resolution:  -0.25
    ...                         ...
    standard_name:              volumetric_soil_moisture
    temporal_resolution:        8D
    time_coverage_end:          2020-12-30T00:00:00.000000000
    time_coverage_start:        1979-01-05T00:00:00.000000000
    time_period:                8D
    units:                      m^3 m^-3</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'sm'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 989</li><li><span class='xr-has-index'>lat</span>: 72</li><li><span class='xr-has-index'>lon</span>: 144</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c1808c27-3d64-40cf-8ccc-9cb85223c943' class='xr-array-in' type='checkbox' checked><label for='section-c1808c27-3d64-40cf-8ccc-9cb85223c943' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(46, 72, 144), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 39.12 MiB </td>
                        <td> 1.82 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (989, 72, 144) </td>
                        <td> (46, 72, 144) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 22 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="171" height="157" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="36" x2="80" y2="107" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="36" style="stroke-width:2" />
  <line x1="13" y1="3" x2="13" y2="40" />
  <line x1="16" y1="6" x2="16" y2="43" />
  <line x1="19" y1="9" x2="19" y2="46" />
  <line x1="23" y1="13" x2="23" y2="49" />
  <line x1="26" y1="16" x2="26" y2="53" />
  <line x1="29" y1="19" x2="29" y2="56" />
  <line x1="36" y1="26" x2="36" y2="63" />
  <line x1="39" y1="29" x2="39" y2="66" />
  <line x1="42" y1="32" x2="42" y2="69" />
  <line x1="46" y1="36" x2="46" y2="72" />
  <line x1="49" y1="39" x2="49" y2="76" />
  <line x1="52" y1="42" x2="52" y2="79" />
  <line x1="59" y1="49" x2="59" y2="86" />
  <line x1="62" y1="52" x2="62" y2="89" />
  <line x1="65" y1="55" x2="65" y2="92" />
  <line x1="69" y1="59" x2="69" y2="95" />
  <line x1="72" y1="62" x2="72" y2="99" />
  <line x1="75" y1="65" x2="75" y2="102" />
  <line x1="80" y1="70" x2="80" y2="107" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,107.36062546187372 10.0,36.772390167756065" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="50" y2="0" style="stroke-width:2" />
  <line x1="13" y1="3" x2="53" y2="3" />
  <line x1="16" y1="6" x2="57" y2="6" />
  <line x1="19" y1="9" x2="60" y2="9" />
  <line x1="23" y1="13" x2="63" y2="13" />
  <line x1="26" y1="16" x2="66" y2="16" />
  <line x1="29" y1="19" x2="70" y2="19" />
  <line x1="36" y1="26" x2="76" y2="26" />
  <line x1="39" y1="29" x2="80" y2="29" />
  <line x1="42" y1="32" x2="83" y2="32" />
  <line x1="46" y1="36" x2="86" y2="36" />
  <line x1="49" y1="39" x2="89" y2="39" />
  <line x1="52" y1="42" x2="93" y2="42" />
  <line x1="59" y1="49" x2="99" y2="49" />
  <line x1="62" y1="52" x2="103" y2="52" />
  <line x1="65" y1="55" x2="106" y2="55" />
  <line x1="69" y1="59" x2="109" y2="59" />
  <line x1="72" y1="62" x2="112" y2="62" />
  <line x1="75" y1="65" x2="116" y2="65" />
  <line x1="80" y1="70" x2="121" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="50" y1="0" x2="121" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 50.561800239783025,0.0 121.15003553390068,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="121" y2="70" style="stroke-width:2" />
  <line x1="80" y1="107" x2="121" y2="107" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="107" style="stroke-width:2" />
  <line x1="121" y1="70" x2="121" y2="107" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 121.15003553390068,70.58823529411765 121.15003553390068,107.36062546187372 80.58823529411765,107.36062546187372" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="100.869135" y="127.360625" font-size="1.0rem" font-weight="100" text-anchor="middle" >144</text>
  <text x="141.150036" y="88.974430" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,141.150036,88.974430)">72</text>
  <text x="35.294118" y="92.066508" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,92.066508)">989</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-bf51eaed-4990-493f-947b-484b7162f44d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bf51eaed-4990-493f-947b-484b7162f44d' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-88.75 -86.25 ... 86.25 88.75</div><input id='attrs-172440fc-728d-4301-83f3-6d1037415ddb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-172440fc-728d-4301-83f3-6d1037415ddb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ccbc2c2-55a5-4c00-9ce4-d0318484cfef' class='xr-var-data-in' type='checkbox'><label for='data-2ccbc2c2-55a5-4c00-9ce4-d0318484cfef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-88.75, -86.25, -83.75, -81.25, -78.75, -76.25, -73.75, -71.25, -68.75,
       -66.25, -63.75, -61.25, -58.75, -56.25, -53.75, -51.25, -48.75, -46.25,
       -43.75, -41.25, -38.75, -36.25, -33.75, -31.25, -28.75, -26.25, -23.75,
       -21.25, -18.75, -16.25, -13.75, -11.25,  -8.75,  -6.25,  -3.75,  -1.25,
         1.25,   3.75,   6.25,   8.75,  11.25,  13.75,  16.25,  18.75,  21.25,
        23.75,  26.25,  28.75,  31.25,  33.75,  36.25,  38.75,  41.25,  43.75,
        46.25,  48.75,  51.25,  53.75,  56.25,  58.75,  61.25,  63.75,  66.25,
        68.75,  71.25,  73.75,  76.25,  78.75,  81.25,  83.75,  86.25,  88.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-178.8 -176.2 ... 176.2 178.8</div><input id='attrs-21b5ddd8-ddf4-44df-9075-e40c34fdd5e1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-21b5ddd8-ddf4-44df-9075-e40c34fdd5e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5f866c0c-77dd-415c-b0ef-ec9092213215' class='xr-var-data-in' type='checkbox'><label for='data-5f866c0c-77dd-415c-b0ef-ec9092213215' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([-178.75, -176.25, -173.75, -171.25, -168.75, -166.25, -163.75, -161.25,
       -158.75, -156.25, -153.75, -151.25, -148.75, -146.25, -143.75, -141.25,
       -138.75, -136.25, -133.75, -131.25, -128.75, -126.25, -123.75, -121.25,
       -118.75, -116.25, -113.75, -111.25, -108.75, -106.25, -103.75, -101.25,
        -98.75,  -96.25,  -93.75,  -91.25,  -88.75,  -86.25,  -83.75,  -81.25,
        -78.75,  -76.25,  -73.75,  -71.25,  -68.75,  -66.25,  -63.75,  -61.25,
        -58.75,  -56.25,  -53.75,  -51.25,  -48.75,  -46.25,  -43.75,  -41.25,
        -38.75,  -36.25,  -33.75,  -31.25,  -28.75,  -26.25,  -23.75,  -21.25,
        -18.75,  -16.25,  -13.75,  -11.25,   -8.75,   -6.25,   -3.75,   -1.25,
          1.25,    3.75,    6.25,    8.75,   11.25,   13.75,   16.25,   18.75,
         21.25,   23.75,   26.25,   28.75,   31.25,   33.75,   36.25,   38.75,
         41.25,   43.75,   46.25,   48.75,   51.25,   53.75,   56.25,   58.75,
         61.25,   63.75,   66.25,   68.75,   71.25,   73.75,   76.25,   78.75,
         81.25,   83.75,   86.25,   88.75,   91.25,   93.75,   96.25,   98.75,
        101.25,  103.75,  106.25,  108.75,  111.25,  113.75,  116.25,  118.75,
        121.25,  123.75,  126.25,  128.75,  131.25,  133.75,  136.25,  138.75,
        141.25,  143.75,  146.25,  148.75,  151.25,  153.75,  156.25,  158.75,
        161.25,  163.75,  166.25,  168.75,  171.25,  173.75,  176.25,  178.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1979-01-09 ... 2021-12-27</div><input id='attrs-7f15d0ae-1972-4f64-8111-898e326f0baf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7f15d0ae-1972-4f64-8111-898e326f0baf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-97bf9c36-cd24-4a1a-87d2-0b6567fe869d' class='xr-var-data-in' type='checkbox'><label for='data-97bf9c36-cd24-4a1a-87d2-0b6567fe869d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1979-01-09T00:00:00.000000000&#x27;, &#x27;1979-01-25T00:00:00.000000000&#x27;,
       &#x27;1979-02-10T00:00:00.000000000&#x27;, ..., &#x27;2021-11-25T00:00:00.000000000&#x27;,
       &#x27;2021-12-11T00:00:00.000000000&#x27;, &#x27;2021-12-27T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b4df8584-c22a-4315-a73e-207dbef230df' class='xr-section-summary-in' type='checkbox'  ><label for='section-b4df8584-c22a-4315-a73e-207dbef230df' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-cc14d1a8-2584-490a-a7e1-ba6b784203a3' class='xr-index-data-in' type='checkbox'/><label for='index-cc14d1a8-2584-490a-a7e1-ba6b784203a3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-88.75, -86.25, -83.75, -81.25, -78.75, -76.25, -73.75, -71.25,
              -68.75, -66.25, -63.75, -61.25, -58.75, -56.25, -53.75, -51.25,
              -48.75, -46.25, -43.75, -41.25, -38.75, -36.25, -33.75, -31.25,
              -28.75, -26.25, -23.75, -21.25, -18.75, -16.25, -13.75, -11.25,
               -8.75,  -6.25,  -3.75,  -1.25,   1.25,   3.75,   6.25,   8.75,
               11.25,  13.75,  16.25,  18.75,  21.25,  23.75,  26.25,  28.75,
               31.25,  33.75,  36.25,  38.75,  41.25,  43.75,  46.25,  48.75,
               51.25,  53.75,  56.25,  58.75,  61.25,  63.75,  66.25,  68.75,
               71.25,  73.75,  76.25,  78.75,  81.25,  83.75,  86.25,  88.75],
             dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d142d3ab-469f-4092-bff9-d7519c545e8a' class='xr-index-data-in' type='checkbox'/><label for='index-d142d3ab-469f-4092-bff9-d7519c545e8a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-178.75, -176.25, -173.75, -171.25, -168.75, -166.25, -163.75,
              -161.25, -158.75, -156.25,
              ...
               156.25,  158.75,  161.25,  163.75,  166.25,  168.75,  171.25,
               173.75,  176.25,  178.75],
             dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a69f9667-df2b-4929-b5ad-0a3a2e8926bf' class='xr-index-data-in' type='checkbox'/><label for='index-a69f9667-df2b-4929-b5ad-0a3a2e8926bf' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1979-01-09&#x27;, &#x27;1979-01-25&#x27;, &#x27;1979-02-10&#x27;, &#x27;1979-02-26&#x27;,
               &#x27;1979-03-14&#x27;, &#x27;1979-03-30&#x27;, &#x27;1979-04-15&#x27;, &#x27;1979-05-01&#x27;,
               &#x27;1979-05-17&#x27;, &#x27;1979-06-02&#x27;,
               ...
               &#x27;2021-08-05&#x27;, &#x27;2021-08-21&#x27;, &#x27;2021-09-06&#x27;, &#x27;2021-09-22&#x27;,
               &#x27;2021-10-08&#x27;, &#x27;2021-10-24&#x27;, &#x27;2021-11-09&#x27;, &#x27;2021-11-25&#x27;,
               &#x27;2021-12-11&#x27;, &#x27;2021-12-27&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=989, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c0b46090-82f1-47c0-9087-a94be3f173fc' class='xr-section-summary-in' type='checkbox'  ><label for='section-c0b46090-82f1-47c0-9087-a94be3f173fc' class='xr-section-summary' >Attributes: <span>(25)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>acknowledgment :</span></dt><dd>ESA Soil Moisture Climate Change Initiative (Soil_Moisture_cci)</dd><dt><span>date_modified :</span></dt><dd>2022-10-13 20:42:41.277132</dd><dt><span>description :</span></dt><dd>ESA Soil Moisture Climate Change Initiative (Soil_Moisture_cci): COMBINED product, Version 06.1</dd><dt><span>geospatial_lat_max :</span></dt><dd>89.875</dd><dt><span>geospatial_lat_min :</span></dt><dd>-89.875</dd><dt><span>geospatial_lat_resolution :</span></dt><dd>-0.25</dd><dt><span>geospatial_lon_max :</span></dt><dd>179.875</dd><dt><span>geospatial_lon_min :</span></dt><dd>-179.875</dd><dt><span>geospatial_lon_resolution :</span></dt><dd>0.25</dd><dt><span>license :</span></dt><dd>Terms and conditions of the DeepESDL data distribution</dd><dt><span>long_name :</span></dt><dd>Volumetric Soil Moisture</dd><dt><span>original_add_offset :</span></dt><dd>0.0</dd><dt><span>original_name :</span></dt><dd>sm</dd><dt><span>original_scale_factor :</span></dt><dd>1.0</dd><dt><span>processing_steps :</span></dt><dd>[&#x27;Merging nc files&#x27;, &#x27;Resampling by 8-day mean&#x27;]</dd><dt><span>project :</span></dt><dd>DeepESDL</dd><dt><span>references :</span></dt><dd>[&#x27;https://data.cci.ceda.ac.uk/thredds/fileServer/esacci/soil_moisture/docs/v06.1/ESA_CCI_SM_RD_D2.1_v2_ATBD_v06.1_issue_1.1.pdf&#x27;, &#x27;https://doi.org/10.5194/essd-11-717-2019&#x27;, &#x27;https://doi.org/10.1016/j.rse.2017.07.001&#x27;]</dd><dt><span>reported_day :</span></dt><dd>5.0</dd><dt><span>source :</span></dt><dd>[&#x27;https://catalogue.ceda.ac.uk/uuid/43d73291472444e6b9c2d2420dbad7d6&#x27;]</dd><dt><span>standard_name :</span></dt><dd>volumetric_soil_moisture</dd><dt><span>temporal_resolution :</span></dt><dd>8D</dd><dt><span>time_coverage_end :</span></dt><dd>2020-12-30T00:00:00.000000000</dd><dt><span>time_coverage_start :</span></dt><dd>1979-01-05T00:00:00.000000000</dd><dt><span>time_period :</span></dt><dd>8D</dd><dt><span>units :</span></dt><dd>m^3 m^-3</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="task-1">
<h2>Task 1:<a class="headerlink" href="#task-1" title="Link to this heading">#</a></h2>
<p>Produce a map of climate classes based on GPP. The classes should be assigned according to energy and water availability (whether temperature and soil moisture at the time of maximum GPP are higher or lower than the annual mean for that location). Temperature and soil moisture are interpreted as the driving climate factors as they set the energy and water limits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Coordinates:
  * lat      (lat) float64 -88.75 -86.25 -83.75 -81.25 ... 83.75 86.25 88.75
  * lon      (lon) float64 -178.8 -176.2 -173.8 -171.2 ... 173.8 176.2 178.8
  * time     (time) datetime64[ns] 1979-01-09 1979-01-25 ... 2021-12-27
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculaate annual mean seasonal cycle (MSC) for each variable</span>
<span class="n">msc_gpp</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">gross_primary_productivity</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">msc_temp</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">air_temperature_2m</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">msc_sm</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sm</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plot the msc for one example pixel lat=36, lon=72</span>
<span class="n">example_pixel_gpp</span> <span class="o">=</span> <span class="n">msc_gpp</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
<span class="n">example_pixel_temp</span> <span class="o">=</span> <span class="n">msc_temp</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
<span class="n">example_pixel_sm</span> <span class="o">=</span> <span class="n">msc_sm</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_pixel_sm</span><span class="o">.</span><span class="n">dayofyear</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;dayofyear&#x27; (dayofyear: 23)&gt;
array([  9,  25,  41,  57,  73,  89, 105, 121, 137, 153, 169, 185, 201, 217,
       233, 249, 265, 281, 297, 313, 329, 345, 361])
Coordinates:
    lat        float64 1.25
    lon        float64 1.25
  * dayofyear  (dayofyear) int64 9 25 41 57 73 89 ... 281 297 313 329 345 361</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'dayofyear'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>dayofyear</span>: 23</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-9c88415f-13cb-4c48-92f4-618f259a2a7f' class='xr-array-in' type='checkbox' checked><label for='section-9c88415f-13cb-4c48-92f4-618f259a2a7f' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>9 25 41 57 73 89 105 121 137 ... 233 249 265 281 297 313 329 345 361</span></div><div class='xr-array-data'><pre>array([  9,  25,  41,  57,  73,  89, 105, 121, 137, 153, 169, 185, 201, 217,
       233, 249, 265, 281, 297, 313, 329, 345, 361])</pre></div></div></li><li class='xr-section-item'><input id='section-ef38acf9-ad1e-4da9-b370-95132e01c27e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ef38acf9-ad1e-4da9-b370-95132e01c27e' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.25</div><input id='attrs-29007642-a1a7-441f-b6bd-41e8783fe4ad' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-29007642-a1a7-441f-b6bd-41e8783fe4ad' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-10246074-a6b6-4aa9-b4f6-5e657fbe01fe' class='xr-var-data-in' type='checkbox'><label for='data-10246074-a6b6-4aa9-b4f6-5e657fbe01fe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array(1.25)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.25</div><input id='attrs-ce6bb1b6-a6fc-4831-a1e6-de219045dba9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ce6bb1b6-a6fc-4831-a1e6-de219045dba9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-31919c6b-7edc-4e6a-a963-913c5ab2954c' class='xr-var-data-in' type='checkbox'><label for='data-31919c6b-7edc-4e6a-a963-913c5ab2954c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array(1.25)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>dayofyear</span></div><div class='xr-var-dims'>(dayofyear)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>9 25 41 57 73 ... 313 329 345 361</div><input id='attrs-5b2e796e-f538-4332-8def-0cb48e9c20c4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5b2e796e-f538-4332-8def-0cb48e9c20c4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dc0eaede-278c-4fa9-9537-12fd7f025112' class='xr-var-data-in' type='checkbox'><label for='data-dc0eaede-278c-4fa9-9537-12fd7f025112' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  9,  25,  41,  57,  73,  89, 105, 121, 137, 153, 169, 185, 201, 217,
       233, 249, 265, 281, 297, 313, 329, 345, 361])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-57f89db0-0c31-42f6-9531-6394064a3e4d' class='xr-section-summary-in' type='checkbox'  ><label for='section-57f89db0-0c31-42f6-9531-6394064a3e4d' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>dayofyear</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c5627014-418b-4f7c-8b72-88a14c81138f' class='xr-index-data-in' type='checkbox'/><label for='index-c5627014-418b-4f7c-8b72-88a14c81138f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([  9,  25,  41,  57,  73,  89, 105, 121, 137, 153, 169, 185, 201,
            217, 233, 249, 265, 281, 297, 313, 329, 345, 361],
           dtype=&#x27;int64&#x27;, name=&#x27;dayofyear&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f4b76327-e1ee-4d3d-9c0e-21f1368ad4a2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f4b76327-e1ee-4d3d-9c0e-21f1368ad4a2' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">example_pixel_temp</span><span class="o">.</span><span class="n">dayofyear</span><span class="p">,</span> <span class="n">example_pixel_temp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Temperature (MSC)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Day of year&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mean Seasonal Cycle </span><span class="se">\n</span><span class="s2"> Example Pixel (lat=36, lon=72)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/672a19eecd735f1465fa20632292af1782c5b7c21326ada98be918119881d7f0.png" src="_images/672a19eecd735f1465fa20632292af1782c5b7c21326ada98be918119881d7f0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## soil moisture problem:</span>
<span class="n">msc_sm</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sm</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mean_sm</span> <span class="o">=</span> <span class="n">msc_sm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">mean_sm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mean Soil Moisture Across All Pixels&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a2706cdd5dfcb1022a12328889844b19335f2e0e8452fbc74edfbbfbacb0e4c0.png" src="_images/a2706cdd5dfcb1022a12328889844b19335f2e0e8452fbc74edfbbfbacb0e4c0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">sm</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">sm</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">gross_primary_productivity</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">gross_primary_productivity</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0 0.68009454
-0.4970202 11.491473
</pre></div>
</div>
</div>
</div>
</section>
<section id="find-the-maximum-gpp-value-in-the-msc-at-each-pixel">
<h2>Find the maximum GPP value in the MSC at each pixel<a class="headerlink" href="#find-the-maximum-gpp-value-in-the-msc-at-each-pixel" title="Link to this heading">#</a></h2>
<p>… plot a map with these maximal GPP values (check e.g. the .max() function)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_gpp</span><span class="o">=</span> <span class="n">msc_gpp</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">max_gpp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;CMRmap&quot;</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Maximum Gross Primary Production Across All Pixels&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c8b4b4c6a5e753c80f2fecd8639143a32af80ae795ab1aed57cc9589bcbb3b10.png" src="_images/c8b4b4c6a5e753c80f2fecd8639143a32af80ae795ab1aed57cc9589bcbb3b10.png" />
</div>
</div>
</section>
<section id="find-out-the-day-of-year-doy-of-maximum-gpp-at-each-pixel-check-idxmax-function">
<h2>Find out the day of year (DOY) of maximum GPP at each pixel (check .idxmax() function)<a class="headerlink" href="#find-out-the-day-of-year-doy-of-maximum-gpp-at-each-pixel-check-idxmax-function" title="Link to this heading">#</a></h2>
<p>…This is your mask to determine temperature and soil moisture at DOY of maximum GPP (it has the same set of values as the dayofyear axis, so you can use it to filter). Plot a map of DOY of maximum GPP to check out the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idmax_gpp</span><span class="o">=</span> <span class="n">msc_gpp</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">idmax_gpp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;CMRmap&quot;</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Day of year (DOY) of maximum GPP Across All Pixels&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4411e903f996de7b654325222ab69e5bb7ecc456b23e73cb8a05e6333d386019.png" src="_images/4411e903f996de7b654325222ab69e5bb7ecc456b23e73cb8a05e6333d386019.png" />
</div>
</div>
</section>
<section id="for-mean-annual-temperature-and-mean-annual-soil-moisture-find-their-values-at-doy-of-maximum-gpp">
<h2>For mean annual temperature and mean annual soil moisture, find their values at DOY of maximum GPP<a class="headerlink" href="#for-mean-annual-temperature-and-mean-annual-soil-moisture-find-their-values-at-doy-of-maximum-gpp" title="Link to this heading">#</a></h2>
<p>… (use e.g. x.where(x[‘dayofyear’] == mask) to mask all data except the corresponding value at DOY of maximum GPP, where x is your xarray). It helps to look at a timeseries at one pixel to understand what is happening. You then need to aggregate by .max(‘dayofyear’, skipna=True) to only retain the one value which is not masked to NaN at each pixel (dropping the dayofyear axis, so you now have a map with lan/lon dimensions only).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msc_gpp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;gross_primary_productivity&#x27; (dayofyear: 23, lat: 72, lon: 144)&gt;
dask.array&lt;stack, shape=(23, 72, 144), dtype=float32, chunksize=(1, 72, 144), chunktype=numpy.ndarray&gt;
Coordinates:
  * lat        (lat) float64 -88.75 -86.25 -83.75 -81.25 ... 83.75 86.25 88.75
  * lon        (lon) float64 -178.8 -176.2 -173.8 -171.2 ... 173.8 176.2 178.8
  * dayofyear  (dayofyear) int64 9 25 41 57 73 89 ... 281 297 313 329 345 361
Attributes: (12/25)
    acknowledgment:             FLUXCOM
    date_modified:              2022-10-17 22:14:30.401506
    description:                FLUXCOM
    geospatial_lat_max:         89.87499928049999
    geospatial_lat_min:         -89.8750000005
    geospatial_lat_resolution:  0.25
    ...                         ...
    standard_name:              gross_primary_productivity_of_carbon
    temporal_resolution:        8D
    time_coverage_end:          2020-12-30T00:00:00.000000000
    time_coverage_start:        2001-01-05T00:00:00.000000000
    time_period:                8D
    units:                      g C m^-2 d^-1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'gross_primary_productivity'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>dayofyear</span>: 23</li><li><span class='xr-has-index'>lat</span>: 72</li><li><span class='xr-has-index'>lon</span>: 144</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-da01b955-ac75-4f33-bc93-9f240f1f7796' class='xr-array-in' type='checkbox' checked><label for='section-da01b955-ac75-4f33-bc93-9f240f1f7796' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 72, 144), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 0.91 MiB </td>
                        <td> 40.50 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (23, 72, 144) </td>
                        <td> (1, 72, 144) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 23 chunks in 118 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="204" height="134" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="60" x2="34" y2="84" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="64" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="69" />
  <line x1="20" y1="10" x2="20" y2="70" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="74" />
  <line x1="25" y1="15" x2="25" y2="75" />
  <line x1="26" y1="16" x2="26" y2="76" />
  <line x1="28" y1="18" x2="28" y2="78" />
  <line x1="29" y1="19" x2="29" y2="79" />
  <line x1="30" y1="20" x2="30" y2="80" />
  <line x1="32" y1="22" x2="32" y2="82" />
  <line x1="34" y1="24" x2="34" y2="84" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.12094749029459,24.12094749029459 34.12094749029459,84.12094749029458 10.0,60.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="26" y1="16" x2="146" y2="16" />
  <line x1="28" y1="18" x2="148" y2="18" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="30" y1="20" x2="150" y2="20" />
  <line x1="32" y1="22" x2="152" y2="22" />
  <line x1="34" y1="24" x2="154" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="130" y1="0" x2="154" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 154.12094749029458,24.12094749029459 34.12094749029459,24.12094749029459" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="154" y2="24" style="stroke-width:2" />
  <line x1="34" y1="84" x2="154" y2="84" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="84" style="stroke-width:2" />
  <line x1="154" y1="24" x2="154" y2="84" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.12094749029459,24.12094749029459 154.12094749029458,24.12094749029459 154.12094749029458,84.12094749029458 34.12094749029459,84.12094749029458" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="94.120947" y="104.120947" font-size="1.0rem" font-weight="100" text-anchor="middle" >144</text>
  <text x="174.120947" y="54.120947" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,174.120947,54.120947)">72</text>
  <text x="12.060474" y="92.060474" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.060474,92.060474)">23</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-1f79ccf2-7ea6-4246-8294-49d1117e8f0c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1f79ccf2-7ea6-4246-8294-49d1117e8f0c' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-88.75 -86.25 ... 86.25 88.75</div><input id='attrs-d30f4c58-c15e-4557-a9c2-076a7406a627' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d30f4c58-c15e-4557-a9c2-076a7406a627' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d098dec-f229-446b-8ee5-681d6f5c86e6' class='xr-var-data-in' type='checkbox'><label for='data-5d098dec-f229-446b-8ee5-681d6f5c86e6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-88.75, -86.25, -83.75, -81.25, -78.75, -76.25, -73.75, -71.25, -68.75,
       -66.25, -63.75, -61.25, -58.75, -56.25, -53.75, -51.25, -48.75, -46.25,
       -43.75, -41.25, -38.75, -36.25, -33.75, -31.25, -28.75, -26.25, -23.75,
       -21.25, -18.75, -16.25, -13.75, -11.25,  -8.75,  -6.25,  -3.75,  -1.25,
         1.25,   3.75,   6.25,   8.75,  11.25,  13.75,  16.25,  18.75,  21.25,
        23.75,  26.25,  28.75,  31.25,  33.75,  36.25,  38.75,  41.25,  43.75,
        46.25,  48.75,  51.25,  53.75,  56.25,  58.75,  61.25,  63.75,  66.25,
        68.75,  71.25,  73.75,  76.25,  78.75,  81.25,  83.75,  86.25,  88.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-178.8 -176.2 ... 176.2 178.8</div><input id='attrs-000684ba-34c1-43be-98b4-f1c51a53a2de' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-000684ba-34c1-43be-98b4-f1c51a53a2de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-531b5bc5-8422-4e83-90fa-0a65ff66e30d' class='xr-var-data-in' type='checkbox'><label for='data-531b5bc5-8422-4e83-90fa-0a65ff66e30d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([-178.75, -176.25, -173.75, -171.25, -168.75, -166.25, -163.75, -161.25,
       -158.75, -156.25, -153.75, -151.25, -148.75, -146.25, -143.75, -141.25,
       -138.75, -136.25, -133.75, -131.25, -128.75, -126.25, -123.75, -121.25,
       -118.75, -116.25, -113.75, -111.25, -108.75, -106.25, -103.75, -101.25,
        -98.75,  -96.25,  -93.75,  -91.25,  -88.75,  -86.25,  -83.75,  -81.25,
        -78.75,  -76.25,  -73.75,  -71.25,  -68.75,  -66.25,  -63.75,  -61.25,
        -58.75,  -56.25,  -53.75,  -51.25,  -48.75,  -46.25,  -43.75,  -41.25,
        -38.75,  -36.25,  -33.75,  -31.25,  -28.75,  -26.25,  -23.75,  -21.25,
        -18.75,  -16.25,  -13.75,  -11.25,   -8.75,   -6.25,   -3.75,   -1.25,
          1.25,    3.75,    6.25,    8.75,   11.25,   13.75,   16.25,   18.75,
         21.25,   23.75,   26.25,   28.75,   31.25,   33.75,   36.25,   38.75,
         41.25,   43.75,   46.25,   48.75,   51.25,   53.75,   56.25,   58.75,
         61.25,   63.75,   66.25,   68.75,   71.25,   73.75,   76.25,   78.75,
         81.25,   83.75,   86.25,   88.75,   91.25,   93.75,   96.25,   98.75,
        101.25,  103.75,  106.25,  108.75,  111.25,  113.75,  116.25,  118.75,
        121.25,  123.75,  126.25,  128.75,  131.25,  133.75,  136.25,  138.75,
        141.25,  143.75,  146.25,  148.75,  151.25,  153.75,  156.25,  158.75,
        161.25,  163.75,  166.25,  168.75,  171.25,  173.75,  176.25,  178.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>dayofyear</span></div><div class='xr-var-dims'>(dayofyear)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>9 25 41 57 73 ... 313 329 345 361</div><input id='attrs-690e33f8-f801-4916-99e1-a0b3ac49b962' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-690e33f8-f801-4916-99e1-a0b3ac49b962' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-13ffe4bb-996a-4a1e-967f-c72a59370451' class='xr-var-data-in' type='checkbox'><label for='data-13ffe4bb-996a-4a1e-967f-c72a59370451' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  9,  25,  41,  57,  73,  89, 105, 121, 137, 153, 169, 185, 201, 217,
       233, 249, 265, 281, 297, 313, 329, 345, 361])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c8457a6a-eacb-410b-b6b2-fbf209fc08d0' class='xr-section-summary-in' type='checkbox'  ><label for='section-c8457a6a-eacb-410b-b6b2-fbf209fc08d0' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4801045c-ce71-4c66-82c7-d5a8c4f6d22e' class='xr-index-data-in' type='checkbox'/><label for='index-4801045c-ce71-4c66-82c7-d5a8c4f6d22e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-88.75, -86.25, -83.75, -81.25, -78.75, -76.25, -73.75, -71.25,
              -68.75, -66.25, -63.75, -61.25, -58.75, -56.25, -53.75, -51.25,
              -48.75, -46.25, -43.75, -41.25, -38.75, -36.25, -33.75, -31.25,
              -28.75, -26.25, -23.75, -21.25, -18.75, -16.25, -13.75, -11.25,
               -8.75,  -6.25,  -3.75,  -1.25,   1.25,   3.75,   6.25,   8.75,
               11.25,  13.75,  16.25,  18.75,  21.25,  23.75,  26.25,  28.75,
               31.25,  33.75,  36.25,  38.75,  41.25,  43.75,  46.25,  48.75,
               51.25,  53.75,  56.25,  58.75,  61.25,  63.75,  66.25,  68.75,
               71.25,  73.75,  76.25,  78.75,  81.25,  83.75,  86.25,  88.75],
             dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b779f888-d7d1-4cd8-a637-db2dcff22083' class='xr-index-data-in' type='checkbox'/><label for='index-b779f888-d7d1-4cd8-a637-db2dcff22083' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-178.75, -176.25, -173.75, -171.25, -168.75, -166.25, -163.75,
              -161.25, -158.75, -156.25,
              ...
               156.25,  158.75,  161.25,  163.75,  166.25,  168.75,  171.25,
               173.75,  176.25,  178.75],
             dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>dayofyear</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f0758771-4a87-4586-a947-1b9870148145' class='xr-index-data-in' type='checkbox'/><label for='index-f0758771-4a87-4586-a947-1b9870148145' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([  9,  25,  41,  57,  73,  89, 105, 121, 137, 153, 169, 185, 201,
            217, 233, 249, 265, 281, 297, 313, 329, 345, 361],
           dtype=&#x27;int64&#x27;, name=&#x27;dayofyear&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-03f8ff7a-cbf8-4086-b885-33c142af37cd' class='xr-section-summary-in' type='checkbox'  ><label for='section-03f8ff7a-cbf8-4086-b885-33c142af37cd' class='xr-section-summary' >Attributes: <span>(25)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>acknowledgment :</span></dt><dd>FLUXCOM</dd><dt><span>date_modified :</span></dt><dd>2022-10-17 22:14:30.401506</dd><dt><span>description :</span></dt><dd>FLUXCOM</dd><dt><span>geospatial_lat_max :</span></dt><dd>89.87499928049999</dd><dt><span>geospatial_lat_min :</span></dt><dd>-89.8750000005</dd><dt><span>geospatial_lat_resolution :</span></dt><dd>0.25</dd><dt><span>geospatial_lon_max :</span></dt><dd>179.87499856049996</dd><dt><span>geospatial_lon_min :</span></dt><dd>-179.8750000005</dd><dt><span>geospatial_lon_resolution :</span></dt><dd>0.25</dd><dt><span>license :</span></dt><dd>Terms and conditions of the DeepESDL data distribution</dd><dt><span>long_name :</span></dt><dd>Gross Primary Productivity</dd><dt><span>original_add_offset :</span></dt><dd>0.0</dd><dt><span>original_name :</span></dt><dd>GPP</dd><dt><span>original_scale_factor :</span></dt><dd>1.0</dd><dt><span>processing_steps :</span></dt><dd>[&#x27;Merging nc files&#x27;, &#x27;Downsampling to 0.25 deg with mean&#x27;]</dd><dt><span>project :</span></dt><dd>DeepESDL</dd><dt><span>references :</span></dt><dd>[&#x27;https://doi.org/10.5194/bg-13-4291-2016&#x27;, &#x27;https://doi.org/10.1038/s41597-019-0076-8&#x27;]</dd><dt><span>reported_day :</span></dt><dd>5.0</dd><dt><span>source :</span></dt><dd>[&#x27;https://www.fluxcom.org/&#x27;]</dd><dt><span>standard_name :</span></dt><dd>gross_primary_productivity_of_carbon</dd><dt><span>temporal_resolution :</span></dt><dd>8D</dd><dt><span>time_coverage_end :</span></dt><dd>2020-12-30T00:00:00.000000000</dd><dt><span>time_coverage_start :</span></dt><dd>2001-01-05T00:00:00.000000000</dd><dt><span>time_period :</span></dt><dd>8D</dd><dt><span>units :</span></dt><dd>g C m^-2 d^-1</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">doy_max_gpp</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">doy_max_gpp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;gross_primary_productivity&#x27; (lat: 72, lon: 144)&gt;
array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]], dtype=float32)
Coordinates:
  * lat      (lat) float64 -88.75 -86.25 -83.75 -81.25 ... 83.75 86.25 88.75
  * lon      (lon) float64 -178.8 -176.2 -173.8 -171.2 ... 173.8 176.2 178.8</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'gross_primary_productivity'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 72</li><li><span class='xr-has-index'>lon</span>: 144</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-30215e19-a6f4-440e-973c-b8cc649d2828' class='xr-array-in' type='checkbox' checked><label for='section-30215e19-a6f4-440e-973c-b8cc649d2828' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan nan nan nan ... nan nan nan nan nan nan nan nan</span></div><div class='xr-array-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-26696ada-dc02-4cee-92ae-fc4e782c89a7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-26696ada-dc02-4cee-92ae-fc4e782c89a7' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-88.75 -86.25 ... 86.25 88.75</div><input id='attrs-bc353db6-2c03-4ad1-8a1b-7e9ed042f546' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bc353db6-2c03-4ad1-8a1b-7e9ed042f546' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fb4d4a66-a561-4795-b680-58338ffe9ad2' class='xr-var-data-in' type='checkbox'><label for='data-fb4d4a66-a561-4795-b680-58338ffe9ad2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-88.75, -86.25, -83.75, -81.25, -78.75, -76.25, -73.75, -71.25, -68.75,
       -66.25, -63.75, -61.25, -58.75, -56.25, -53.75, -51.25, -48.75, -46.25,
       -43.75, -41.25, -38.75, -36.25, -33.75, -31.25, -28.75, -26.25, -23.75,
       -21.25, -18.75, -16.25, -13.75, -11.25,  -8.75,  -6.25,  -3.75,  -1.25,
         1.25,   3.75,   6.25,   8.75,  11.25,  13.75,  16.25,  18.75,  21.25,
        23.75,  26.25,  28.75,  31.25,  33.75,  36.25,  38.75,  41.25,  43.75,
        46.25,  48.75,  51.25,  53.75,  56.25,  58.75,  61.25,  63.75,  66.25,
        68.75,  71.25,  73.75,  76.25,  78.75,  81.25,  83.75,  86.25,  88.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-178.8 -176.2 ... 176.2 178.8</div><input id='attrs-ebcf84e2-5692-4ff6-8866-f9d496fe76d7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ebcf84e2-5692-4ff6-8866-f9d496fe76d7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ec8ca9a2-95a8-49ec-92fb-0f58a1629536' class='xr-var-data-in' type='checkbox'><label for='data-ec8ca9a2-95a8-49ec-92fb-0f58a1629536' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([-178.75, -176.25, -173.75, -171.25, -168.75, -166.25, -163.75, -161.25,
       -158.75, -156.25, -153.75, -151.25, -148.75, -146.25, -143.75, -141.25,
       -138.75, -136.25, -133.75, -131.25, -128.75, -126.25, -123.75, -121.25,
       -118.75, -116.25, -113.75, -111.25, -108.75, -106.25, -103.75, -101.25,
        -98.75,  -96.25,  -93.75,  -91.25,  -88.75,  -86.25,  -83.75,  -81.25,
        -78.75,  -76.25,  -73.75,  -71.25,  -68.75,  -66.25,  -63.75,  -61.25,
        -58.75,  -56.25,  -53.75,  -51.25,  -48.75,  -46.25,  -43.75,  -41.25,
        -38.75,  -36.25,  -33.75,  -31.25,  -28.75,  -26.25,  -23.75,  -21.25,
        -18.75,  -16.25,  -13.75,  -11.25,   -8.75,   -6.25,   -3.75,   -1.25,
          1.25,    3.75,    6.25,    8.75,   11.25,   13.75,   16.25,   18.75,
         21.25,   23.75,   26.25,   28.75,   31.25,   33.75,   36.25,   38.75,
         41.25,   43.75,   46.25,   48.75,   51.25,   53.75,   56.25,   58.75,
         61.25,   63.75,   66.25,   68.75,   71.25,   73.75,   76.25,   78.75,
         81.25,   83.75,   86.25,   88.75,   91.25,   93.75,   96.25,   98.75,
        101.25,  103.75,  106.25,  108.75,  111.25,  113.75,  116.25,  118.75,
        121.25,  123.75,  126.25,  128.75,  131.25,  133.75,  136.25,  138.75,
        141.25,  143.75,  146.25,  148.75,  151.25,  153.75,  156.25,  158.75,
        161.25,  163.75,  166.25,  168.75,  171.25,  173.75,  176.25,  178.75])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-249946f0-9740-4bcd-800d-15c10ddcb314' class='xr-section-summary-in' type='checkbox'  ><label for='section-249946f0-9740-4bcd-800d-15c10ddcb314' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-39674096-b29a-44ac-a4d9-4654e2bae260' class='xr-index-data-in' type='checkbox'/><label for='index-39674096-b29a-44ac-a4d9-4654e2bae260' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-88.75, -86.25, -83.75, -81.25, -78.75, -76.25, -73.75, -71.25,
              -68.75, -66.25, -63.75, -61.25, -58.75, -56.25, -53.75, -51.25,
              -48.75, -46.25, -43.75, -41.25, -38.75, -36.25, -33.75, -31.25,
              -28.75, -26.25, -23.75, -21.25, -18.75, -16.25, -13.75, -11.25,
               -8.75,  -6.25,  -3.75,  -1.25,   1.25,   3.75,   6.25,   8.75,
               11.25,  13.75,  16.25,  18.75,  21.25,  23.75,  26.25,  28.75,
               31.25,  33.75,  36.25,  38.75,  41.25,  43.75,  46.25,  48.75,
               51.25,  53.75,  56.25,  58.75,  61.25,  63.75,  66.25,  68.75,
               71.25,  73.75,  76.25,  78.75,  81.25,  83.75,  86.25,  88.75],
             dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d69e3a4c-5f14-4926-9124-fdd9f367fa6f' class='xr-index-data-in' type='checkbox'/><label for='index-d69e3a4c-5f14-4926-9124-fdd9f367fa6f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-178.75, -176.25, -173.75, -171.25, -168.75, -166.25, -163.75,
              -161.25, -158.75, -156.25,
              ...
               156.25,  158.75,  161.25,  163.75,  166.25,  168.75,  171.25,
               173.75,  176.25,  178.75],
             dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ed54ebda-c8f7-4632-9ed8-e0ec8c5d0e57' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ed54ebda-c8f7-4632-9ed8-e0ec8c5d0e57' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idmax_gpp</span><span class="o">=</span> <span class="n">msc_gpp</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">)</span>
<span class="n">doy_gpp_msc_temp</span> <span class="o">=</span> <span class="n">msc_temp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">msc_temp</span><span class="p">[</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">idmax_gpp</span><span class="p">)</span> 
<span class="n">doy_gpp_msc_sm</span> <span class="o">=</span> <span class="n">msc_sm</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">msc_sm</span><span class="p">[</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">idmax_gpp</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#aggregate to retain the non-masked value</span>
<span class="n">final_temp</span> <span class="o">=</span> <span class="n">doy_gpp_msc_temp</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">final_sm</span> <span class="o">=</span> <span class="n">doy_gpp_msc_sm</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#final plot </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">final_temp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mean Annual Temperature at DOY of Maximun GPP&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">final_sm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGnBu&#39;</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mean Soil Moisture at DOY of Maximun GPP&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Mean Soil Moisture at DOY of Maximun GPP&#39;)
</pre></div>
</div>
<img alt="_images/c17c67d68be5412abb3e5056a06b4cd205e623a5025bbcfe30fbc4c7309d32e8.png" src="_images/c17c67d68be5412abb3e5056a06b4cd205e623a5025bbcfe30fbc4c7309d32e8.png" />
<img alt="_images/2215f7c2312db8f3d28a43b629dd7c76725b7be70353e7c4d761153333d0878c.png" src="_images/2215f7c2312db8f3d28a43b629dd7c76725b7be70353e7c4d761153333d0878c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#scatter plot to see how temperature and soil moisture are related with</span>
<span class="c1">#maximun GPP</span>

<span class="n">temp_values</span> <span class="o">=</span> <span class="n">final_temp</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">sm_values</span> <span class="o">=</span> <span class="n">final_sm</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1">#remove nan values for both variables</span>
<span class="n">mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">temp_values</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sm_values</span><span class="p">)</span>
<span class="n">temp_clean</span> <span class="o">=</span> <span class="n">temp_values</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">sm_clean</span> <span class="o">=</span> <span class="n">sm_values</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="c1"># Create a scatter plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">temp_clean</span><span class="p">,</span> <span class="n">sm_clean</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Mean Annual Temperature at DOY of Max GPP (K)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean Annual Soil Moisture at DOY of Max GPP&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Relationship between Temperature and Soil Moisture at Peak GPP&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e49f8f937bc7b23d652a62abd6ef180e32ba072b63a9d5e9dd29427e9e837ceb.png" src="_images/e49f8f937bc7b23d652a62abd6ef180e32ba072b63a9d5e9dd29427e9e837ceb.png" />
</div>
</div>
<ul class="simple">
<li><p>The scatter plot expose a smothed linear correlation between the variables</p></li>
<li><p>There are three areas with a dense concentration of data points</p></li>
<li><p>The areas with concentration of points can be identified as:</p>
<ul>
<li><p>Lower temperatures, <span class="math notranslate nohighlight">\([0, 5)^{o}C\)</span></p></li>
<li><p>Medium temperatures, <span class="math notranslate nohighlight">\([10, 20)^{o}C\)</span></p></li>
<li><p>High temperatures, <span class="math notranslate nohighlight">\([25, 30]^{o}C\)</span></p></li>
</ul>
</li>
<li><p>This distribution of values allows us to reflect that these correlations might follow a type of seasonal pattern</p></li>
</ul>
</section>
<section id="determine-if-these-values-are-larger-smaller-than-the-average-temperature-and-soil-moisture-at-each-pixel">
<h2>Determine if these values are larger/smaller than the average temperature and soil moisture at each pixel<a class="headerlink" href="#determine-if-these-values-are-larger-smaller-than-the-average-temperature-and-soil-moisture-at-each-pixel" title="Link to this heading">#</a></h2>
<p>…(You can calculate their averages from the MSC cubes from step 1 with .mean(), to lower computation cost)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## compare values at DOY of Maximum GPP of MSC values</span>
<span class="n">temp_comparison</span> <span class="o">=</span> <span class="n">final_temp</span> <span class="o">&gt;</span> <span class="n">msc_temp</span>
<span class="c1">#print(temp_comparison)</span>
<span class="n">sm_comparison</span> <span class="o">=</span> <span class="n">final_sm</span> <span class="o">&gt;</span> <span class="n">msc_sm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># count pizels above/below avg</span>
<span class="n">num_higher_temp</span> <span class="o">=</span> <span class="n">temp_comparison</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">num_lower_temp</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">temp_comparison</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">num_higher_sm</span> <span class="o">=</span> <span class="n">sm_comparison</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">num_lower_sm</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">sm_comparison</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of pixels where temperature at max GPP is higher than average: </span><span class="si">{</span><span class="n">num_higher_temp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of pixels where temperature at max GPP is lower than average: </span><span class="si">{</span><span class="n">num_lower_temp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of pixels where soil moisture at max GPP is higher than average: </span><span class="si">{</span><span class="n">num_higher_sm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of pixels where soil moisture at max GPP is lower than average: </span><span class="si">{</span><span class="n">num_lower_sm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of pixels where temperature at max GPP is higher than average: 51257
Number of pixels where temperature at max GPP is lower than average: 187207
Number of pixels where soil moisture at max GPP is higher than average: 35062
Number of pixels where soil moisture at max GPP is lower than average: 203402
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulating the difference between temperature and soil moisture at DOY of max GPP and their average</span>
<span class="n">temp_diff</span> <span class="o">=</span> <span class="n">final_temp</span> <span class="o">-</span> <span class="n">msc_temp</span> 
<span class="n">sm_diff</span> <span class="o">=</span> <span class="n">final_sm</span> <span class="o">-</span> <span class="n">msc_sm</span>  
</pre></div>
</div>
</div>
</div>
<p><strong>Classification based on the difference:</strong></p>
<ul class="simple">
<li><p>Class 1: Higher temp, higher soil moisture</p></li>
<li><p>Class 2: Higher temp, lower soil moisture</p></li>
<li><p>Class 3: Lower temp, higher soil moisture</p></li>
<li><p>Class 4: Lower temp, lower soil moisture</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classification</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="p">(</span><span class="n">temp_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sm_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Higher temp and higher soil moisture</span>
    <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="p">(</span><span class="n">temp_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sm_diff</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Higher temp and lower soil moisture</span>
        <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">temp_diff</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sm_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span>  <span class="c1"># Lower temp and higher soil moisture</span>
            <span class="mi">4</span>  <span class="c1"># Lower temp and lower soil moisture</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Plot the maximum GPP map</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">max_gpp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlGn&quot;</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Maximum GPP Across All Pixels&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ce417c7f96c64796afb212ab19bb1398ace426d4e410ba58ec992e3f739530dd.png" src="_images/ce417c7f96c64796afb212ab19bb1398ace426d4e410ba58ec992e3f739530dd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classification</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (lat: 72, lon: 144, dayofyear: 23)&gt;
dask.array&lt;where, shape=(72, 144, 23), dtype=int64, chunksize=(72, 144, 1), chunktype=numpy.ndarray&gt;
Coordinates:
  * lat        (lat) float64 -88.75 -86.25 -83.75 -81.25 ... 83.75 86.25 88.75
  * lon        (lon) float64 -178.8 -176.2 -173.8 -171.2 ... 173.8 176.2 178.8
  * dayofyear  (dayofyear) int64 9 25 41 57 73 89 ... 281 297 313 329 345 361</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 72</li><li><span class='xr-has-index'>lon</span>: 144</li><li><span class='xr-has-index'>dayofyear</span>: 23</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-a153000c-bfe5-4ed0-a157-2a2babb0f5ed' class='xr-array-in' type='checkbox' checked><label for='section-a153000c-bfe5-4ed0-a157-2a2babb0f5ed' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(72, 144, 1), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.82 MiB </td>
                        <td> 81.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (72, 144, 23) </td>
                        <td> (72, 144, 1) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 23 chunks in 405 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="136" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.294117647058826,35.294117647058826 45.294117647058826,155.29411764705884 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="51" y2="0" style="stroke-width:2" />
  <line x1="45" y1="35" x2="86" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="11" y1="0" x2="47" y2="35" />
  <line x1="13" y1="0" x2="48" y2="35" />
  <line x1="15" y1="0" x2="50" y2="35" />
  <line x1="17" y1="0" x2="52" y2="35" />
  <line x1="20" y1="0" x2="55" y2="35" />
  <line x1="22" y1="0" x2="57" y2="35" />
  <line x1="24" y1="0" x2="59" y2="35" />
  <line x1="26" y1="0" x2="61" y2="35" />
  <line x1="27" y1="0" x2="63" y2="35" />
  <line x1="31" y1="0" x2="66" y2="35" />
  <line x1="33" y1="0" x2="68" y2="35" />
  <line x1="34" y1="0" x2="70" y2="35" />
  <line x1="36" y1="0" x2="72" y2="35" />
  <line x1="38" y1="0" x2="73" y2="35" />
  <line x1="42" y1="0" x2="77" y2="35" />
  <line x1="43" y1="0" x2="79" y2="35" />
  <line x1="45" y1="0" x2="80" y2="35" />
  <line x1="47" y1="0" x2="82" y2="35" />
  <line x1="51" y1="0" x2="86" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 51.0056107335008,0.0 86.29972838055963,35.294117647058826 45.294117647058826,35.294117647058826" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="86" y2="35" style="stroke-width:2" />
  <line x1="45" y1="155" x2="86" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="47" y1="35" x2="47" y2="155" />
  <line x1="48" y1="35" x2="48" y2="155" />
  <line x1="50" y1="35" x2="50" y2="155" />
  <line x1="52" y1="35" x2="52" y2="155" />
  <line x1="55" y1="35" x2="55" y2="155" />
  <line x1="57" y1="35" x2="57" y2="155" />
  <line x1="59" y1="35" x2="59" y2="155" />
  <line x1="61" y1="35" x2="61" y2="155" />
  <line x1="63" y1="35" x2="63" y2="155" />
  <line x1="66" y1="35" x2="66" y2="155" />
  <line x1="68" y1="35" x2="68" y2="155" />
  <line x1="70" y1="35" x2="70" y2="155" />
  <line x1="72" y1="35" x2="72" y2="155" />
  <line x1="73" y1="35" x2="73" y2="155" />
  <line x1="77" y1="35" x2="77" y2="155" />
  <line x1="79" y1="35" x2="79" y2="155" />
  <line x1="80" y1="35" x2="80" y2="155" />
  <line x1="82" y1="35" x2="82" y2="155" />
  <line x1="86" y1="35" x2="86" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.294117647058826,35.294117647058826 86.29972838055963,35.294117647058826 86.29972838055963,155.29411764705884 45.294117647058826,155.29411764705884" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="65.796923" y="175.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" >23</text>
  <text x="106.299728" y="95.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,106.299728,95.294118)">144</text>
  <text x="17.647059" y="157.647059" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.647059,157.647059)">72</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-5ee64ef4-f4a9-4655-88db-90b21fc98ed7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5ee64ef4-f4a9-4655-88db-90b21fc98ed7' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-88.75 -86.25 ... 86.25 88.75</div><input id='attrs-d9ed15b7-4217-4634-8750-9f121c5eb14c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d9ed15b7-4217-4634-8750-9f121c5eb14c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6f606538-ecad-4806-91fa-b3d0856129aa' class='xr-var-data-in' type='checkbox'><label for='data-6f606538-ecad-4806-91fa-b3d0856129aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-88.75, -86.25, -83.75, -81.25, -78.75, -76.25, -73.75, -71.25, -68.75,
       -66.25, -63.75, -61.25, -58.75, -56.25, -53.75, -51.25, -48.75, -46.25,
       -43.75, -41.25, -38.75, -36.25, -33.75, -31.25, -28.75, -26.25, -23.75,
       -21.25, -18.75, -16.25, -13.75, -11.25,  -8.75,  -6.25,  -3.75,  -1.25,
         1.25,   3.75,   6.25,   8.75,  11.25,  13.75,  16.25,  18.75,  21.25,
        23.75,  26.25,  28.75,  31.25,  33.75,  36.25,  38.75,  41.25,  43.75,
        46.25,  48.75,  51.25,  53.75,  56.25,  58.75,  61.25,  63.75,  66.25,
        68.75,  71.25,  73.75,  76.25,  78.75,  81.25,  83.75,  86.25,  88.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-178.8 -176.2 ... 176.2 178.8</div><input id='attrs-61e543a4-518e-430b-a992-e86b4bbca609' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-61e543a4-518e-430b-a992-e86b4bbca609' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-feca15fe-89ba-4a19-8cbb-44c25942068b' class='xr-var-data-in' type='checkbox'><label for='data-feca15fe-89ba-4a19-8cbb-44c25942068b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-178.75, -176.25, -173.75, -171.25, -168.75, -166.25, -163.75, -161.25,
       -158.75, -156.25, -153.75, -151.25, -148.75, -146.25, -143.75, -141.25,
       -138.75, -136.25, -133.75, -131.25, -128.75, -126.25, -123.75, -121.25,
       -118.75, -116.25, -113.75, -111.25, -108.75, -106.25, -103.75, -101.25,
        -98.75,  -96.25,  -93.75,  -91.25,  -88.75,  -86.25,  -83.75,  -81.25,
        -78.75,  -76.25,  -73.75,  -71.25,  -68.75,  -66.25,  -63.75,  -61.25,
        -58.75,  -56.25,  -53.75,  -51.25,  -48.75,  -46.25,  -43.75,  -41.25,
        -38.75,  -36.25,  -33.75,  -31.25,  -28.75,  -26.25,  -23.75,  -21.25,
        -18.75,  -16.25,  -13.75,  -11.25,   -8.75,   -6.25,   -3.75,   -1.25,
          1.25,    3.75,    6.25,    8.75,   11.25,   13.75,   16.25,   18.75,
         21.25,   23.75,   26.25,   28.75,   31.25,   33.75,   36.25,   38.75,
         41.25,   43.75,   46.25,   48.75,   51.25,   53.75,   56.25,   58.75,
         61.25,   63.75,   66.25,   68.75,   71.25,   73.75,   76.25,   78.75,
         81.25,   83.75,   86.25,   88.75,   91.25,   93.75,   96.25,   98.75,
        101.25,  103.75,  106.25,  108.75,  111.25,  113.75,  116.25,  118.75,
        121.25,  123.75,  126.25,  128.75,  131.25,  133.75,  136.25,  138.75,
        141.25,  143.75,  146.25,  148.75,  151.25,  153.75,  156.25,  158.75,
        161.25,  163.75,  166.25,  168.75,  171.25,  173.75,  176.25,  178.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>dayofyear</span></div><div class='xr-var-dims'>(dayofyear)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>9 25 41 57 73 ... 313 329 345 361</div><input id='attrs-45a20f6a-0821-4f45-a366-5a9c880866aa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-45a20f6a-0821-4f45-a366-5a9c880866aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d2bb7bed-b5c6-4d30-b793-a16e786f954d' class='xr-var-data-in' type='checkbox'><label for='data-d2bb7bed-b5c6-4d30-b793-a16e786f954d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  9,  25,  41,  57,  73,  89, 105, 121, 137, 153, 169, 185, 201, 217,
       233, 249, 265, 281, 297, 313, 329, 345, 361])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2347b7bf-c14e-4172-bd39-af46067c3041' class='xr-section-summary-in' type='checkbox'  ><label for='section-2347b7bf-c14e-4172-bd39-af46067c3041' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a39b2169-bb40-452c-8d39-7a762f1f9042' class='xr-index-data-in' type='checkbox'/><label for='index-a39b2169-bb40-452c-8d39-7a762f1f9042' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-88.75, -86.25, -83.75, -81.25, -78.75, -76.25, -73.75, -71.25,
              -68.75, -66.25, -63.75, -61.25, -58.75, -56.25, -53.75, -51.25,
              -48.75, -46.25, -43.75, -41.25, -38.75, -36.25, -33.75, -31.25,
              -28.75, -26.25, -23.75, -21.25, -18.75, -16.25, -13.75, -11.25,
               -8.75,  -6.25,  -3.75,  -1.25,   1.25,   3.75,   6.25,   8.75,
               11.25,  13.75,  16.25,  18.75,  21.25,  23.75,  26.25,  28.75,
               31.25,  33.75,  36.25,  38.75,  41.25,  43.75,  46.25,  48.75,
               51.25,  53.75,  56.25,  58.75,  61.25,  63.75,  66.25,  68.75,
               71.25,  73.75,  76.25,  78.75,  81.25,  83.75,  86.25,  88.75],
             dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f26e82ce-b14a-4ac5-bc2d-b404211de161' class='xr-index-data-in' type='checkbox'/><label for='index-f26e82ce-b14a-4ac5-bc2d-b404211de161' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-178.75, -176.25, -173.75, -171.25, -168.75, -166.25, -163.75,
              -161.25, -158.75, -156.25,
              ...
               156.25,  158.75,  161.25,  163.75,  166.25,  168.75,  171.25,
               173.75,  176.25,  178.75],
             dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>dayofyear</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a26c8577-bfca-4d11-83b6-c6eb64c15909' class='xr-index-data-in' type='checkbox'/><label for='index-a26c8577-bfca-4d11-83b6-c6eb64c15909' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([  9,  25,  41,  57,  73,  89, 105, 121, 137, 153, 169, 185, 201,
            217, 233, 249, 265, 281, 297, 313, 329, 345, 361],
           dtype=&#x27;int64&#x27;, name=&#x27;dayofyear&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bd9779d5-536d-43ba-b154-edb253ad72b5' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-bd9779d5-536d-43ba-b154-edb253ad72b5' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">temp_diff</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">temp_diff</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sm_diff</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">sm_diff</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-23.95262 59.143486
-0.18098153 0.23257232
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classification</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="p">(</span><span class="n">temp_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sm_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="p">(</span><span class="n">temp_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sm_diff</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">temp_diff</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sm_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span>
            <span class="mi">4</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">classification</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[4 4 4 ... 4 4 4]
 [4 4 4 ... 4 4 4]
 [4 4 4 ... 4 4 4]
 ...
 [4 4 4 ... 4 4 4]
 [4 4 4 ... 4 4 4]
 [4 4 4 ... 4 4 4]]
[1 2 3 4]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#check classification attributes</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
<span class="n">classification</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">lat</span>
<span class="n">classification</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">lon</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;lat&#39;, &#39;lon&#39;, &#39;dayofyear&#39;)
Coordinates:
  * lat        (lat) float64 -88.75 -86.25 -83.75 -81.25 ... 83.75 86.25 88.75
  * lon        (lon) float64 -178.8 -176.2 -173.8 -171.2 ... 173.8 176.2 178.8
  * dayofyear  (dayofyear) int64 9 25 41 57 73 89 ... 281 297 313 329 345 361
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classification_2d</span> <span class="o">=</span> <span class="n">classification</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">dayofyear</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Example for DOY 10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">classification_2d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;tab10&quot;</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Classification of Temperature and Soil Moisture Difference at DOY of Max GPP&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b0239a8a878ea245af05e58a5e5889eb000029e47691039a12b58a9ce2944d4f.png" src="_images/b0239a8a878ea245af05e58a5e5889eb000029e47691039a12b58a9ce2944d4f.png" />
</div>
</div>
<section id="conclusions-classification">
<h3>Conclusions Classification<a class="headerlink" href="#conclusions-classification" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The ocean which corresponds to Class 4: Lower temp, lower soil moisture, is well visualized on the map, covering the background</p></li>
<li><p>In the case of Class 3: Lower temp, higher soil moisture. Regions such as Africa and Europe are marked in this range</p></li>
<li><p>Higher and lower latitudes are represented in the Class 2: Lower temp, higher soil moisture</p></li>
<li><p>Finally, regions on the intertropical convergence zone are classified in Class 1: Higher temp, higher soil moisture</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Anomalies_and_ENSO.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Climatology, anomalies and El Nino Southern Oscillation</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-from-vegetation-information">Classification from vegetation information</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-climate-classification-based-on-climate-and-vegetation">Exercise: Climate classification based on climate and vegetation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-1">Task 1:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-maximum-gpp-value-in-the-msc-at-each-pixel">Find the maximum GPP value in the MSC at each pixel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-out-the-day-of-year-doy-of-maximum-gpp-at-each-pixel-check-idxmax-function">Find out the day of year (DOY) of maximum GPP at each pixel (check .idxmax() function)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-mean-annual-temperature-and-mean-annual-soil-moisture-find-their-values-at-doy-of-maximum-gpp">For mean annual temperature and mean annual soil moisture, find their values at DOY of maximum GPP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-if-these-values-are-larger-smaller-than-the-average-temperature-and-soil-moisture-at-each-pixel">Determine if these values are larger/smaller than the average temperature and soil moisture at each pixel</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions-classification">Conclusions Classification</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gloria Carrascal
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>